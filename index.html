<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ö–æ–ª–æ–±–æ–∫: –ü—Ä—è—Ç–∫–∏</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #e0f7fa; /* –¢–æ—Ç —Å–∞–º—ã–π –≥–æ–ª—É–±–æ–π —Ñ–æ–Ω */
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
            touch-action: none;
        }

        #ui-layer {
            text-align: center;
            padding: 10px;
            z-index: 20;
            background: rgba(255,255,255,0.8);
            width: 100%;
            border-bottom: 2px solid #81d4fa;
        }

        .map-box {
            display: inline-flex;
            gap: 15px;
            margin-top: 10px;
            padding: 10px;
            background: white;
            border-radius: 10px;
        }

        .mini {
            font-size: 30px;
            padding: 5px;
            border: 3px solid transparent;
            border-radius: 8px;
        }

        .active-target {
            border-color: #4caf50;
            background: #e8f5e9;
        }

        #game-zone {
            position: relative;
            flex-grow: 1;
            width: 100%;
            background: #8bc34a; /* –ó–µ–ª–µ–Ω–∞—è —Ç—Ä–∞–≤–∞ */
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            align-items: center;
        }

        #kolobok {
            font-size: 80px;
            cursor: pointer;
            z-index: 100;
            position: relative;
            user-select: none;
            transition: transform 0.1s;
            display: block;
        }

        #shelters-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding-bottom: 40px;
        }

        .item {
            font-size: 80px;
            width: 120px;
            height: 120px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
        }

        #fox {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 60px;
            transition: 0.5s;
        }

        #win-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: none;
            z-index: 1000;
            text-align: center;
        }

        button {
            padding: 15px 30px;
            font-size: 20px;
            background: #ff9800;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div id="ui-layer">
        <b style="font-size: 20px;">–°–ü–†–Ø–ß–¨ –ö–û–õ–û–ë–ö–ê!</b>

        <span>–ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –∫–∞—Ä—Ç—É:</span>
        <div class="map-box" id="minimap"></div>
    </div>

    <div id="game-zone">
        <div id="fox">ü¶ä</div>
        <div id="kolobok">ü•Ø</div>
        <div id="shelters-grid"></div>
    </div>

    <div id="win-modal" id="modal">
        <h2 style="color: #2e7d32;">–£—Ä–∞! –õ–∏—Å–∞ —É–±–µ–∂–∞–ª–∞! ü¶äüí®</h2>
        <button onclick="location.reload()">–ò–ì–†–ê–¢–¨ –ï–©–Å</button>
    </div>

    <script>
        const data = [
            { id: 't1', img: 'ü™µ' },
            { id: 't2', img: 'üåø' },
            { id: 't3', img: 'üå≤' },
            { id: 't4', img: 'üçÑ' }
        ];

        let goal = '';
        const kolobok = document.getElementById('kolobok');
        const grid = document.getElementById('shelters-grid');
        const minimap = document.getElementById('minimap');

        function start() {
            // –í—ã–±–∏—Ä–∞–µ–º —Ü–µ–ª—å
            const rand = Math


(Math.random() * data.length);
            goal = data[rand].id;

            // –†–∏—Å—É–µ–º –∫–∞—Ä—Ç—É
            minimap.innerHTML = data.map(i => `
                <div class="mini ${i.id === goal ? 'active-target' : ''}">${i.img}</div>
            `).join('');

            // –†–∏—Å—É–µ–º —É–∫—Ä—ã—Ç–∏—è
            grid.innerHTML = data.map(i => `
                <div class="item" data-id="${i.id}">${i.img}</div>
            `).join('');
        }

        // –õ–æ–≥–∏–∫–∞ –¥–≤–∏–∂–µ–Ω–∏—è
        let isMoving = false;
        let offset = { x: 0, y: 0 };

        function onStart(e) {
            isMoving = true;
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            const rect = kolobok.getBoundingClientRect();
            offset.x = clientX - rect.left - rect.width/2;
            offset.y = clientY - rect.top - rect.height/2;
        }

        function onMove(e) {
            if (!isMoving) return;
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            
            const x = clientX - offset.x - (window.innerWidth / 2);
            const y = clientY - offset.y - 250; // –ü—Ä–∏–º–µ—Ä–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Ü–µ–Ω—Ç—Ä–∞
            
            kolobok.style.transform = `translate(${x}px, ${y}px)`;
        }

        function onEnd(e) {
            if (!isMoving) return;
            isMoving = false;

            const kRect = kolobok.getBoundingClientRect();
            const kX = kRect.left + kRect.width/2;
            const kY = kRect.top + kRect.height/2;

            let hit = null;
            document.querySelectorAll('.item').forEach(el.floor
